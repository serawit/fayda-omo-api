{"version":3,"file":"customer.controller.js","sourceRoot":"","sources":["../../src/controllers/customer.controller.ts"],"names":[],"mappings":"AACA,OAAO,IAAI,MAAM,gBAAgB,CAAC;AAElC,MAAM,CAAC,MAAM,oBAAoB,GAAG,KAAK,EAAE,GAAY,EAAE,GAAa,EAAE,EAAE;IACxE,IAAI,CAAC;QACH,MAAM,IAAI,GAAG,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,IAAc,CAAC,IAAI,CAAC,CAAC;QACrD,MAAM,KAAK,GAAG,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,KAAe,CAAC,IAAI,EAAE,CAAC;QACxD,MAAM,MAAM,GAAG,GAAG,CAAC,KAAK,CAAC,MAAgB,CAAC;QAC1C,MAAM,IAAI,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC;QAGhC,MAAM,KAAK,GAAQ,EAAE,SAAS,EAAE,UAAU,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;QAE3D,IAAI,MAAM,EAAE,CAAC;YACX,MAAM,WAAW,GAAG,IAAI,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;YAC5C,KAAK,CAAC,GAAG,GAAG;gBACV,EAAE,QAAQ,EAAE,WAAW,EAAE;gBACzB,EAAE,aAAa,EAAE,WAAW,EAAE;aAC/B,CAAC;QACJ,CAAC;QAED,MAAM,CAAC,SAAS,EAAE,KAAK,CAAC,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC;YAC3C,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;iBACb,MAAM,CAAC,WAAW,CAAC;iBACnB,IAAI,CAAC,EAAE,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC;iBACvB,IAAI,CAAC,IAAI,CAAC;iBACV,KAAK,CAAC,KAAK,CAAC;YACf,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC;SAC3B,CAAC,CAAC;QAEH,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;YACnB,OAAO,EAAE,IAAI;YACb,IAAI,EAAE,SAAS;YACf,UAAU,EAAE;gBACV,OAAO,EAAE,IAAI;gBACb,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;gBAC/B,KAAK;gBACL,KAAK;aACN;SACF,CAAC,CAAC;IACL,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,CAAC,KAAK,CAAC,oCAAoC,EAAE,KAAK,CAAC,CAAC;QAC3D,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,cAAc,EAAE,CAAC,CAAC;IACpE,CAAC;AACH,CAAC,CAAC","sourcesContent":["import { Request, Response } from 'express';\r\nimport User from '../models/User';\r\n\r\nexport const getVerifiedCustomers = async (req: Request, res: Response) => {\r\n  try {\r\n    const page = parseInt(req.query.page as string) || 1;\r\n    const limit = parseInt(req.query.limit as string) || 10;\r\n    const search = req.query.search as string;\r\n    const skip = (page - 1) * limit;\r\n\r\n    // Filter for verified users only\r\n    const query: any = { kycStatus: 'VERIFIED', role: 'user' };\r\n\r\n    if (search) {\r\n      const searchRegex = new RegExp(search, 'i');\r\n      query.$or = [\r\n        { fullName: searchRegex },\r\n        { accountNumber: searchRegex }\r\n      ];\r\n    }\r\n\r\n    const [customers, total] = await Promise.all([\r\n      User.find(query)\r\n        .select('-password') // Exclude sensitive data\r\n        .sort({ createdAt: -1 }) // Newest first\r\n        .skip(skip)\r\n        .limit(limit),\r\n      User.countDocuments(query)\r\n    ]);\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      data: customers,\r\n      pagination: {\r\n        current: page,\r\n        pages: Math.ceil(total / limit),\r\n        total,\r\n        limit\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.error('Error fetching verified customers:', error);\r\n    res.status(500).json({ success: false, message: 'Server Error' });\r\n  }\r\n};"]}
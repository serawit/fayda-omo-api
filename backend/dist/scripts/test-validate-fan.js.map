{"version":3,"file":"test-validate-fan.js","sourceRoot":"","sources":["../../src/scripts/test-validate-fan.ts"],"names":[],"mappings":"AAAA,OAAO,GAAG,MAAM,cAAc,CAAC;AAC/B,OAAO,MAAM,MAAM,QAAQ,CAAC;AAE5B,MAAM,CAAC,MAAM,EAAE,CAAC;AAEhB,MAAM,UAAU,GAAG,OAAO,CAAC,GAAG,CAAC,UAAU,IAAI,8DAA8D,CAAC;AAC5G,MAAM,QAAQ,GAAG,yCAAyC,CAAC;AAE3D,MAAM,OAAO,GAAG,KAAK,IAAI,EAAE;IACzB,OAAO,CAAC,GAAG,CAAC,oCAAoC,CAAC,CAAC;IAIlD,MAAM,KAAK,GAAG,GAAG,CAAC,IAAI,CACpB;QACE,MAAM,EAAE,eAAe;QACvB,aAAa,EAAE,OAAO;KACvB,EACD,UAAU,EACV,EAAE,SAAS,EAAE,IAAI,EAAE,CACpB,CAAC;IAEF,OAAO,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;IAGvC,MAAM,SAAS,GAAG;QAChB,EAAE,IAAI,EAAE,uBAAuB,EAAE,GAAG,EAAE,kBAAkB,EAAE,cAAc,EAAE,GAAG,EAAE;QAC/E,EAAE,IAAI,EAAE,wBAAwB,EAAE,GAAG,EAAE,OAAO,EAAE,cAAc,EAAE,GAAG,EAAE;QACrE,EAAE,IAAI,EAAE,wBAAwB,EAAE,GAAG,EAAE,kBAAkB,EAAE,cAAc,EAAE,GAAG,EAAE;KACjF,CAAC;IAGF,KAAK,MAAM,IAAI,IAAI,SAAS,EAAE,CAAC;QAC7B,OAAO,CAAC,GAAG,CAAC,iBAAiB,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;QAE1C,IAAI,CAAC;YACH,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,GAAG,QAAQ,eAAe,EAAE;gBACvD,MAAM,EAAE,MAAM;gBACd,OAAO,EAAE;oBACP,cAAc,EAAE,kBAAkB;oBAClC,eAAe,EAAE,UAAU,KAAK,EAAE;iBACnC;gBACD,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC;aACxC,CAAC,CAAC;YAEH,MAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;YAEnC,MAAM,UAAU,GAAG,QAAQ,CAAC,MAAM,KAAK,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC;YACvE,OAAO,CAAC,GAAG,CAAC,MAAM,UAAU,YAAY,QAAQ,CAAC,MAAM,eAAe,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC;YAC9F,OAAO,CAAC,GAAG,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;QAEvC,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,OAAO,CAAC,KAAK,CAAC,+CAA+C,EAAE,KAAK,CAAC,CAAC;QACxE,CAAC;IACH,CAAC;AACH,CAAC,CAAC;AAEF,OAAO,EAAE,CAAC","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport dotenv from 'dotenv';\r\n\r\ndotenv.config();\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'aX7$kP9mW#vL2qR8tY4nJ6bF0cH3zQ5xM1pD9eU2gA8rT6yB4iO0wS!vN@jK';\r\nconst BASE_URL = 'http://localhost:5000/api/harmonization';\r\n\r\nconst runTest = async () => {\r\n  console.log('ğŸ§ª Starting API Test: Validate FAN');\r\n\r\n  // 1. Create a valid JWT token (simulating a logged-in user)\r\n  // This matches the payload structure expected by your auth middleware\r\n  const token = jwt.sign(\r\n    { \r\n      userId: 'test_user_123', \r\n      accountNumber: '10001' \r\n    }, \r\n    JWT_SECRET, \r\n    { expiresIn: '1h' }\r\n  );\r\n\r\n  console.log('ğŸ”‘ Generated Test Token');\r\n\r\n  // 2. Define test cases\r\n  const testCases = [\r\n    { name: 'Valid FAN (16 digits)', fan: '1234567890123456', expectedStatus: 200 },\r\n    { name: 'Invalid Length (Short)', fan: '12345', expectedStatus: 400 },\r\n    { name: 'Not Found (Mock Logic)', fan: '0000000000000000', expectedStatus: 404 },\r\n  ];\r\n\r\n  // 3. Run tests\r\n  for (const test of testCases) {\r\n    console.log(`\\nğŸ‘‰ Testing: ${test.name}`);\r\n    \r\n    try {\r\n      const response = await fetch(`${BASE_URL}/validate-fan`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${token}`\r\n        },\r\n        body: JSON.stringify({ fan: test.fan })\r\n      });\r\n\r\n      const data = await response.json();\r\n      \r\n      const statusIcon = response.status === test.expectedStatus ? 'âœ…' : 'âŒ';\r\n      console.log(`   ${statusIcon} Status: ${response.status} (Expected: ${test.expectedStatus})`);\r\n      console.log(`   ğŸ“„ Response:`, data);\r\n\r\n    } catch (error) {\r\n      console.error('   âŒ Request Failed (Is the server running?):', error);\r\n    }\r\n  }\r\n};\r\n\r\nrunTest();"]}